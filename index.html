<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ご主人様タイプ診断｜PO・TORO Presents（画像絶対パス版）</title>
<style>
  :root{ --bg:#fff8fc; --card:#ffffff; --ink:#2a2a2a; --accent:#ff68b7; --muted:#7a7a7a; }
  html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);
    font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans JP","Hiragino Kaku Gothic ProN","Meiryo","Helvetica Neue",Arial,sans-serif;}
  .container{max-width:940px;margin:26px auto;padding:16px}
  .card{background:var(--card);border-radius:18px;padding:20px;margin-bottom:18px;
    box-shadow:0 10px 28px rgba(255,104,183,.18), 0 6px 16px rgba(0,0,0,.06)}
  .q{margin:16px 0 12px;font-weight:800}
  .opts{display:grid;grid-template-columns:1fr;gap:9px}
  .opt{border:1.8px solid #f7d9eb;border-radius:12px;padding:12px 14px;background:#fff;cursor:pointer}
  .opt.selected{border-color:var(--accent);background:#fff2f8}
  @media (min-width:760px){ .opts{grid-template-columns:1fr 1fr} }
  .controls{display:flex;gap:12px;flex-wrap:wrap;margin-top:12px}
  button{appearance:none;border:none;border-radius:999px;padding:12px 18px;font-weight:900;cursor:pointer;background:var(--accent);color:#fff}
  button.secondary{background:#f3f3f3;color:#333}
  .result{border:2px dashed #ffd3ea;border-radius:16px;padding:16px;background:linear-gradient(180deg,#fff,#fff6fb)}
  .illustWrap{display:flex;justify-content:center;margin:6px 0 12px}
  .illust{width:100%;max-width:520px;aspect-ratio:1/1;overflow:hidden;border-radius:18px;background:#fff;border:8px solid #ffd7ec;display:flex;align-items:center;justify-content:center;position:relative}
  .illust img{width:100%;height:100%;object-fit:cover;display:block}
  .ph{background:linear-gradient(135deg,#fff0f7,#ffe6f2);color:#c45a96;font-weight:900;letter-spacing:.5px;font-size:1.05rem;display:flex;align-items:center;justify-content:center;width:100%;height:100%}
  .err{color:#c21d5a;font-weight:800;margin-top:6px}
  .footer{text-align:center;color:#777;font-size:.9rem;margin-top:10px}
</style>
</head>
<body>
<div class="container">
  <div class="card">
    <h1>ご主人様タイプ診断</h1>
    <p style="color:#777">※ 画像は <code>/potro-quiz/img/</code> を参照します。リポジトリ名が違う場合は下の <code>BASE</code> を変更してください。</p>
  </div>

  <div id="quiz"></div>

  <div class="card">
    <div class="controls">
      <button id="btnSubmit">結果を見る</button>
      <button id="btnReset" class="secondary">やり直す</button>
    </div>
  </div>

  <div id="resultCard" class="card" style="display:none;">
    <div class="result">
      <div class="illustWrap">
        <figure class="illust" aria-label="結果イラスト">
          <img id="illustImg" alt="タイプ別イラスト" style="display:none" />
          <div id="illustPh" class="ph">タイプ別イラストがここに表示されます</div>
        </figure>
      </div>
      <div id="resultTitle" style="font-size:1.2rem;font-weight:900;margin-bottom:6px;"></div>
      <div id="resultDesc" style="color:#555;line-height:1.9;"></div>
      <div id="imgErr" class="err"></div>
    </div>
  </div>

  <div class="footer">© PO・TORO</div>
</div>

<script>
// GitHub Pages のベース（repo名が potro-quiz の場合）
const BASE = "/potro-quiz/img/";

const ILLUSTRATIONS = {
  "A": BASE + "type_A_relax.png",
  "B": BASE + "type_B_genki.png",
  "C": BASE + "type_C_cool.png",
  "D": BASE + "type_D_mystic.png",
  "E": BASE + "type_E_cute.png",
  "F": BASE + "type_F_support.png",
  "G": BASE + "type_G_otaku.png",
};

// ↓ 画像読み込みエラーが出たら、どのURLを読みに行ったか表示（デバッグ用）
const img = document.getElementById("illustImg");
const ph  = document.getElementById("illustPh");
const err = document.getElementById("imgErr"); // なければ <div id="imgErr"></div> を結果カード内に追加
function showIllust(url){
  img.style.display="none"; ph.style.display="flex"; err.textContent="";
  img.onload = ()=>{ ph.style.display="none"; img.style.display="block"; };
  img.onerror = ()=>{ ph.style.display="flex"; err.textContent = "画像が見つかりません: " + url; };
  img.src = url + "?v=" + Date.now(); // キャッシュ回避
}
</script>

/* タイプ */
const TYPES = [
  {key:"A",label:"ほっと一息ご主人様",desc:"やさしい安らぎ系。"},
  {key:"B",label:"フルスロットルご主人様",desc:"場を明るくする盛り上げ系。"},
  {key:"C",label:"静かに嗜むご主人様",desc:"上質で落ち着いた大人の余裕。"},
  {key:"D",label:"夢見心地ご主人様",desc:"世界観を楽しむ幻想派。"},
  {key:"E",label:"きゅんきゅんご主人様",desc:"可愛さを満喫するキュン系。"},
  {key:"F",label:"相談ウェルカムご主人様",desc:"安心と信頼の寄り添い系。"},
  {key:"G",label:"語り尽くしご主人様",desc:"知と熱量のオタク談義系。"},
];

/* 設問（9問/7択）— 既に共有済みの内容 */
const QUESTIONS = [
  { q:"ポ・トロにご帰宅する目的は？",
    a:[
      { text:"ゆったり癒されたい", typeIndex:0 },
      { text:"思いっきり盛り上がりたい！", typeIndex:1 },
      { text:"静かに大人っぽく過ごしたい", typeIndex:2 },
      { text:"非日常の世界に浸りたい", typeIndex:3 },
      { text:"可愛さで心を満たしたい", typeIndex:4 },
      { text:"ちょっと話を聞いてほしい", typeIndex:5 },
      { text:"推しや趣味を語りたい！", typeIndex:6 },
    ]},
  { q:"お出迎えの際にかけられたい一言は？",
    a:[
      { text:"ご主人様、お疲れ様です。ゆっくりしていってくださいね", typeIndex:0 },
      { text:"やっほーっ！一緒に盛り上がっちゃいましょー！", typeIndex:1 },
      { text:"大丈夫。今日は私に任せて安心してね", typeIndex:5 },
      { text:"ふふっ、ご主人様だけに特別な秘密を教えちゃうかも…？", typeIndex:3 },
      { text:"えへへ〜、来てくれてとっても嬉しいのですっ", typeIndex:4 },
      { text:"困ったらいつでも相談してね。しっかり支えてあげるから", typeIndex:5 },
      { text:"あのアニメ見ました！語り合えるの嬉しすぎます〜！", typeIndex:6 },
    ]},
  { q:"会話の雰囲気の理想は？",
    a:[
      { text:"穏やかに、優しい声で", typeIndex:0 },
      { text:"賑やかに、元気な声で", typeIndex:1 },
      { text:"落ち着いて、トーン低めで", typeIndex:2 },
      { text:"ささやき気味で、雰囲気重視", typeIndex:3 },
      { text:"リアクション可愛めでキュン多め", typeIndex:4 },
      { text:"ゆったり寄り添って丁寧に", typeIndex:5 },
      { text:"テンポ可変、深堀りしやすく", typeIndex:6 },
    ]},
  { q:"好きな雰囲気は？",
    a:[
      { text:"ご主人様を包み込む、ほわほわ癒し空間", typeIndex:0 },
      { text:"みんなで『萌え萌えきゅん♪』と盛り上がるにぎやか空間", typeIndex:1 },
      { text:"落ち着いたトーンで、お酒とお話をゆっくり楽しめる空間", typeIndex:2 },
      { text:"ランプの光や不思議なBGMに包まれる幻想的な空間", typeIndex:3 },
      { text:"かわいい声と仕草が飛び交う、きゅんきゅん萌え空間", typeIndex:4 },
      { text:"『おかえりなさい』に安心する、頼れるメイドさんが待つ空間", typeIndex:5 },
      { text:"メイドさんと一緒に推しやアニメの話で盛り上がるオタク空間", typeIndex:6 },
    ]},
  { q:"ポ・トロでよく飲むドリンクは？",
    a:[
      { text:"あたたかい紅茶やカフェオレ", typeIndex:0 },
      { text:"フルーツジュース", typeIndex:1 },
      { text:"ノンアルコールカクテル", typeIndex:2 },
      { text:"冷たいコーンポタージュ", typeIndex:3 },
      { text:"ミルクやココア", typeIndex:4 },
      { text:"ビールやハイボール", typeIndex:5 },
      { text:"ブラックコーヒー", typeIndex:6 },
    ]},
  { q:"メイドさんと一緒にしたいことは？",
    a:[
      { text:"のんびりお話して、心をぽかぽか癒してほしい", typeIndex:0 },
      { text:"チェキやゲームで、全力で盛り上がりたい！", typeIndex:1 },
      { text:"おしゃれにドリンクを傾けながら、大人な会話を楽しみたい", typeIndex:2 },
      { text:"非日常な世界観に二人でどっぷり浸りたい", typeIndex:3 },
      { text:"メイドさんに甘やかされて、とことん可愛がられたい", typeIndex:4 },
      { text:"メイドさんに相談されたり、頼ってもらいたい", typeIndex:5 },
      { text:"推し活トークやアニメ・ゲーム談義で盛り上がりたい", typeIndex:6 },
    ]},
  { q:"お見送りの際の理想は？",
    a:[
      { text:"すっかり癒されて、笑顔で帰りたい", typeIndex:0 },
      { text:"『楽しかったー！』と元気いっぱいで帰りたい", typeIndex:1 },
      { text:"落ち着いた気分で『また来たいな』と思いながら帰りたい", typeIndex:2 },
      { text:"不思議な余韻に浸りながら帰りたい", typeIndex:3 },
      { text:"胸いっぱいに『可愛い！』を抱えて帰りたい", typeIndex:4 },
      { text:"『やっぱり頼れるなぁ』と安心しながら帰りたい", typeIndex:5 },
      { text:"推しや趣味の話を語り尽くして満足して帰りたい", typeIndex:6 },
    ]},
  { q:"推し選ぶ基準は？",
    a:[
      { text:"やさしい微笑みと癒しのオーラ", typeIndex:0 },
      { text:"場を明るくする元気とテンション", typeIndex:1 },
      { text:"落ち着きと大人の余裕", typeIndex:2 },
      { text:"個性的でミステリアスな雰囲気", typeIndex:3 },
      { text:"あざと可愛い仕草とキュンとさせる魅力", typeIndex:4 },
      { text:"包み込んでくれる安心感と頼れる存在感", typeIndex:5 },
      { text:"推しや趣味を一緒に熱く語れるトーク力", typeIndex:6 },
    ]},
  { q:"何代目のメイド服が好き？",
    a:[
      { text:"やっぱり伝統の初代が好き", typeIndex:0 },
      { text:"大人っぽい雰囲気の弐代目が好き", typeIndex:2 },
      { text:"キュートさ全開の参代目が好き", typeIndex:4 },
      { text:"幻想的な雰囲気の四代目が好き", typeIndex:3 },
      { text:"元気いっぱいの五代目が好き", typeIndex:1 },
      { text:"包容力を感じる六代目が好き", typeIndex:5 },
      { text:"推し活トークが似合う七代目が好き", typeIndex:6 },
    ]},
];

const elQuiz=document.getElementById("quiz");
const elResult=document.getElementById("resultCard");
const elTitle=document.getElementById("resultTitle");
const elDesc=document.getElementById("resultDesc");
const illustImg=document.getElementById("illustImg");
const illustPh=document.getElementById("illustPh");
const imgErr=document.getElementById("imgErr");

function renderQuiz(){
  elQuiz.innerHTML="";
  QUESTIONS.forEach((q,idx)=>{
    const card=document.createElement("div"); card.className="card";
    const qEl=document.createElement("div"); qEl.className="q"; qEl.textContent=`Q${idx+1}. ${q.q}`;
    card.appendChild(qEl);
    const opts=document.createElement("div"); opts.className="opts";
    q.a.forEach(opt=>{
      const btn=document.createElement("div"); btn.className="opt"; btn.textContent=opt.text;
      btn.onclick=()=>{ opts.querySelectorAll(".opt").forEach(o=>o.classList.remove("selected"));
        btn.classList.add("selected"); card.dataset.answer=String(opt.typeIndex); };
      opts.appendChild(btn);
    });
    card.appendChild(opts); elQuiz.appendChild(card);
  });
}

function computeResult(){
  const cards=[...elQuiz.querySelectorAll(".card")];
  const counts=Array(TYPES.length).fill(0);
  for(const c of cards){
    if(!("answer" in c.dataset)) return {error:"未回答の設問があります。"};
    const t=Number(c.dataset.answer); if(Number.isFinite(t)) counts[t]++; }
  let max=-1, idx=-1; counts.forEach((v,i)=>{ if(v>max){ max=v; idx=i; } });
  return { idx };
}

function showResult(){
  const r=computeResult(); if(r.error){ alert(r.error); return; }
  const t=TYPES[r.idx];
  const url = ILLUSTRATIONS[t.key];

  illustImg.style.display="none"; illustPh.style.display="flex"; imgErr.textContent="";
  illustImg.onload=()=>{ illustPh.style.display="none"; illustImg.style.display="block"; };
  illustImg.onerror=()=>{ illustPh.style.display="flex"; imgErr.textContent = "画像が見つかりません: " + url; };
  illustImg.src = url + "?v=" + Date.now(); // キャッシュ回避

  elTitle.textContent=`貴方は『${t.label}』！`;
  elDesc.textContent=t.desc;
  elResult.style.display="block";
  window.scrollTo({ top: elResult.offsetTop - 12, behavior:"smooth" });
}

function resetQuiz(){ renderQuiz(); elResult.style.display="none"; }
document.addEventListener("DOMContentLoaded", renderQuiz);
document.getElementById("btnSubmit").onclick=showResult;
document.getElementById("btnReset").onclick=resetQuiz;
</script>
</body>
</html>
