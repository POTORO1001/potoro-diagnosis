<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ポ・トロ 診断テスト（7タイプ／9問）</title>
<style>
  :root {
    --bg: #fff9fe;
    --card: #ffffff;
    --ink: #2b2b2b;
    --accent: #ff66b3;
    --muted: #777;
  }
  html, body {
    margin: 0; padding: 0; background: var(--bg); color: var(--ink);
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Noto Sans JP", "Hiragino Kaku Gothic ProN", "Meiryo", "Helvetica Neue", Arial, sans-serif;
  }
  .container { max-width: 860px; margin: 24px auto; padding: 16px; }
  .card {
    background: var(--card); border-radius: 16px; box-shadow: 0 6px 24px rgba(0,0,0,0.06);
    padding: 20px; margin-bottom: 16px;
  }
  h1 { font-size: 1.6rem; margin: 0 0 8px; }
  p.lead { color: var(--muted); margin-top: 4px; }
  .q { margin: 16px 0 12px; font-weight: 700; }
  .opts { display: grid; grid-template-columns: 1fr; gap: 8px; }
  .opt {
    border: 1.5px solid #f3d2e7; border-radius: 12px; padding: 12px 14px; cursor: pointer;
    transition: transform .06s ease, border-color .15s ease, background .15s ease;
    user-select: none; background: #fff;
  }
  .opt:hover { transform: translateY(-1px); }
  .opt.selected { border-color: var(--accent); background: #fff2f8; }
  .controls { display: flex; gap: 12px; flex-wrap: wrap; margin-top: 12px; }
  button {
    appearance: none; border: none; border-radius: 999px; padding: 12px 18px;
    font-weight: 700; cursor: pointer; background: var(--accent); color: white;
    box-shadow: 0 4px 14px rgba(255,102,179,.35);
  }
  button.secondary { background: #f2f2f2; color: #333; box-shadow: none; }
  .result {
    border: 2px dashed #ffd3e9; border-radius: 16px; padding: 16px; background: #fffdfd;
  }
  .pill {
    display: inline-block; padding: 6px 10px; border-radius: 999px; background: #ffe3f1; color: #b03d79; font-weight: 700; font-size: 0.9rem;
    margin-right: 8px; margin-bottom: 6px;
  }
  .small { color: var(--muted); font-size: 0.92rem; }
  .footer { text-align: center; color: var(--muted); font-size: 0.86rem; margin-top: 14px; }
  @media (min-width: 720px) { .opts { grid-template-columns: 1fr 1fr; } }
</style>
</head>
<body>
  <div class="container">
    <div class="card">
      <h1>ポ・トロ診断（7タイプ／9問）</h1>
      <p class="lead">「ご主人様は〇〇タイプ！今日のお給仕は△△メイドがオススメです💖」が分かる自己診断。全9問に答えて結果をチェック！</p>
    </div>

    <div id="quiz"></div>

    <div class="card">
      <div class="controls">
        <button id="btnSubmit">結果を見る</button>
        <button class="secondary" id="btnReset">やり直す</button>
      </div>
      <p class="small">※タイプ・メイド割当・質問文はファイル内の <strong>TYPES</strong> / <strong>QUESTIONS</strong> で編集できます。</p>
    </div>

    <div id="resultCard" class="card" style="display:none;">
      <div class="result">
        <div id="resultTitle" style="font-size:1.2rem; font-weight:800; margin-bottom:6px;"></div>
        <div id="resultRecommend" style="margin-bottom:8px;"></div>
        <div id="resultDesc" class="small"></div>
        <div id="secondBest" class="small" style="margin-top:10px; display:none;"></div>
      </div>
    </div>

    <div class="footer">© Po・TRO</div>
  </div>

<script>
const TYPES = [
  { key: "A", label: "癒し系タイプ", desc: "ほっと一息。優しい時間を求めるご主人様。", maids: ["おと", "なぎ", "ゆの"] },
  { key: "B", label: "元気っ子タイプ", desc: "わいわい楽しく！エネルギー補給したいご主人様。", maids: ["うな", "ミカ", "りあ"] },
  { key: "C", label: "大人クールタイプ", desc: "落ち着きと安心感。しっとり過ごしたいご主人様。", maids: ["まりん", "まろ"] },
  { key: "D", label: "不思議幻想タイプ", desc: "個性的で幻想的な世界観に浸りたいご主人様。", maids: ["卯月", "るな", "れい"] },
  { key: "E", label: "甘えんぼタイプ", desc: "可愛い要素に全振り！とことん癒されたいご主人様。", maids: ["海月", "ねね"] },
  { key: "F", label: "お姉さん包容タイプ", desc: "包み込む安心感。頼れる先輩に甘えたいご主人様。", maids: ["べあ", "みお"] },
  { key: "G", label: "オタク談義タイプ", desc: "推し活・趣味語りで盛り上がりたいご主人様。", maids: ["しぐれ", "ぷぷ", "ソフィア"] },
];

const QUESTIONS = [
  {
    q: "今日はどんな気分でポ・トロに来ましたか？",
    a: [
      { text: "ゆったり癒されたい", typeIndex: 0 },
      { text: "元気をもらって盛り上がりたい！", typeIndex: 1 },
      { text: "落ち着いた時間を静かに楽しみたい", typeIndex: 2 },
      { text: "ちょっと不思議な世界に浸りたい", typeIndex: 3 },
      { text: "可愛さに包まれてキュンとしたい", typeIndex: 4 },
      { text: "優しいお姉さんに包まれたい", typeIndex: 5 },
      { text: "趣味や推しの話を思いっきり語りたい！", typeIndex: 6 },
    ]
  },
  {
    q: "今飲みたいドリンクは？",
    a: [
      { text: "あたたかい紅茶やカフェオレでほっと一息", typeIndex: 0 },
      { text: "しゅわしゅわ炭酸系でテンションUP！", typeIndex: 1 },
      { text: "ノンアルコールカクテルで大人の雰囲気", typeIndex: 2 },
      { text: "冷たいコーンポタージュを試し飲み", typeIndex: 3 },
      { text: "ミルクやココアで可愛さ補給", typeIndex: 4 },
      { text: "ビールやハイボールで居酒屋気分♪", typeIndex: 5 },
      { text: "ブラックコーヒーでオタクトーク全開！", typeIndex: 6 },
    ]
  },
  {
    q: "かけられたい一言は？",
    a: [
      { text: "ご主人様、お疲れさまです💖 ゆっくりしていってくださいね", typeIndex: 0 },
      { text: "やっほーっ！一緒に盛り上がっちゃいましょー！", typeIndex: 1 },
      { text: "大丈夫。今日はわたしに任せて安心してね", typeIndex: 2 },
      { text: "ふふっ、ご主人様だけに特別な秘密を教えちゃうかも…？", typeIndex: 3 },
      { text: "えへへ〜、来てくれてとっても嬉しいのですっ", typeIndex: 4 },
      { text: "困ったらいつでも頼ってね。しっかり支えてあげるから", typeIndex: 5 },
      { text: "そのアニメ観ました！？語り合えるの嬉しすぎます〜！", typeIndex: 6 },
    ]
  },
  {
    q: "好きな雰囲気は？",
    a: [
      { text: "ご主人様を包み込む、ほわほわ癒し空間", typeIndex: 0 },
      { text: "みんなで『萌え萌えきゅん♪』と盛り上がるにぎやか空間", typeIndex: 1 },
      { text: "落ち着いたトーンで、お酒とお話をゆっくり楽しめる空間", typeIndex: 2 },
      { text: "ランプの光や不思議なBGMに包まれる幻想的な空間", typeIndex: 3 },
      { text: "かわいい声と仕草が飛び交う、きゅんきゅん萌え空間", typeIndex: 4 },
      { text: "『おかえりなさい』に安心する、頼れるお姉さんが待つ空間", typeIndex: 5 },
      { text: "メイドさんと一緒に推しやアニメの話で盛り上がるオタク空間", typeIndex: 6 },
    ]
  },
  {
    q: "一緒にしたいことは？",
    a: [
      { text: "のんびりお話して、心をぽかぽか癒してほしい", typeIndex: 0 },
      { text: "チェキやゲームで、全力で盛り上がりたい！", typeIndex: 1 },
      { text: "おしゃれにドリンクを傾けながら、大人な会話を楽しみたい", typeIndex: 2 },
      { text: "非日常な世界観にひたって、不思議体験を味わいたい", typeIndex: 3 },
      { text: "メイドさんに甘やかされて、とことん可愛がられたい", typeIndex: 4 },
      { text: "優しいお姉さんに相談したり、頼らせてもらいたい", typeIndex: 5 },
      { text: "推し活トークやアニメ・ゲーム談義で盛り上がりたい", typeIndex: 6 },
    ]
  },
  {
    q: "推しポイントで選ぶなら？",
    a: [
      { text: "やさしい微笑みと癒しのオーラ", typeIndex: 0 },
      { text: "場を明るくする元気とテンション", typeIndex: 1 },
      { text: "落ち着きと大人の余裕", typeIndex: 2 },
      { text: "個性的でミステリアスな雰囲気", typeIndex: 3 },
      { text: "あざと可愛い仕草とキュンとさせる魅力", typeIndex: 4 },
      { text: "包み込んでくれる安心感と頼れる存在感", typeIndex: 5 },
      { text: "推しや趣味を一緒に熱く語れるトーク力", typeIndex: 6 },
    ]
  },
  {
    q: "席に着いた最初のひと言は？",
    a: [
      { text: "ご主人様、今日はお疲れですね…ほっと一息つきましょうか💖", typeIndex: 0 },
      { text: "ご主人様〜！今日は一緒に盛り上がっちゃいましょう！", typeIndex: 1 },
      { text: "ご主人様、静かにゆったりと過ごしたいお気分ですか？", typeIndex: 2 },
      { text: "ご主人様、不思議な世界に迷い込んだ気分じゃありませんか？", typeIndex: 3 },
      { text: "ご主人様〜♡ もっともっとかまってくださいっ！", typeIndex: 4 },
      { text: "ご主人様、今日あったこと…私にぜんぶお話していいんですよ", typeIndex: 5 },
      { text: "ご主人様！あのアニメの最新話、もうチェックされましたか！？", typeIndex: 6 },
    ]
  },
  {
    q: "帰り際の理想は？",
    a: [
      { text: "すっかり癒されて、笑顔で帰りたい", typeIndex: 0 },
      { text: "『楽しかったー！』と元気いっぱいで帰りたい", typeIndex: 1 },
      { text: "落ち着いた気分で『また来たいな』と思いながら帰りたい", typeIndex: 2 },
      { text: "不思議な余韻に浸りながら帰りたい", typeIndex: 3 },
      { text: "胸いっぱいに『可愛い！』を抱えて帰りたい", typeIndex: 4 },
      { text: "『やっぱり頼れるなぁ』と安心しながら帰りたい", typeIndex: 5 },
      { text: "推しや趣味の話を語り尽くして満足して帰りたい", typeIndex: 6 },
    ]
  },
  {
    q: "何代目のメイド服が好き？",
    a: [
      { text: "やっぱり伝統の初代が一番好き！", typeIndex: 0 },
      { text: "大人っぽい雰囲気の弐代目が好き", typeIndex: 2 },
      { text: "キュートさ全開の参代目が好き", typeIndex: 4 },
      { text: "幻想的な雰囲気の四代目が好き", typeIndex: 3 },
      { text: "元気いっぱいの五代目が好き", typeIndex: 1 },
      { text: "包容力を感じる六代目が好き", typeIndex: 5 },
      { text: "推し活トークが似合う七代目が好き", typeIndex: 6 },
    ]
  },
];

// ===== 実装（共通） =====
const elQuiz = document.getElementById("quiz");
const elResult = document.getElementById("resultCard");
const elTitle = document.getElementById("resultTitle");
const elRec = document.getElementById("resultRecommend");
const elDesc = document.getElementById("resultDesc");
const elSecond = document.getElementById("secondBest");

function renderQuiz() {
  elQuiz.innerHTML = "";
  QUESTIONS.forEach((q, idx) => {
    const card = document.createElement("div");
    card.className = "card";
    const qEl = document.createElement("div");
    qEl.className = "q";
    qEl.textContent = `Q${idx+1}. ${q.q}`;
    card.appendChild(qEl);

    const opts = document.createElement("div");
    opts.className = "opts";
    q.a.forEach((opt) => {
      const btn = document.createElement("div");
      btn.className = "opt";
      btn.textContent = opt.text;
      btn.setAttribute("role", "button");
      btn.setAttribute("tabindex", "0");
      btn.onclick = () => {
        opts.querySelectorAll(".opt").forEach(o => o.classList.remove("selected"));
        btn.classList.add("selected");
        card.dataset.answer = String(opt.typeIndex);
      };
      btn.onkeydown = (e) => { if (e.key === "Enter") btn.click(); };
      opts.appendChild(btn);
    });
    card.appendChild(opts);
    elQuiz.appendChild(card);
  });
}

function computeResult() {
  const cards = Array.from(elQuiz.querySelectorAll(".card"));
  const counts = Array(TYPES.length).fill(0);
  for (const c of cards) {
    if (!("answer" in c.dataset)) {
      return { error: "未回答の設問があります。" };
    }
    const t = Number(c.dataset.answer);
    if (!Number.isFinite(t) || t < 0 || t >= TYPES.length) continue;
    counts[t]++;
  }
  let max = -1, maxIdx = -1;
  counts.forEach((v,i)=>{ if (v > max) { max = v; maxIdx = i; } });
  const secondScores = counts.map((v,i)=>({v,i})).filter(x=>x.i!==maxIdx).sort((a,b)=>b.v-a.v);
  const secondBest = secondScores.length ? secondScores[0] : null;
  return { maxIdx, counts, secondBest };
}

function showResult() {
  const r = computeResult();
  if (r.error) { alert(r.error); return; }
  const t = TYPES[r.maxIdx];
  elTitle.textContent = `ご主人様は『${t.label}』！`;
  elRec.innerHTML = `今日のお給仕は <span class="pill">${t.maids.join("・")}</span> メイドがオススメです💖`;
  elDesc.textContent = t.desc;
  if (r.secondBest && r.secondBest.v > 0) {
    const s = TYPES[r.secondBest.i];
    elSecond.style.display = "block";
    elSecond.textContent = `次点：『${s.label}』（おすすめ：${s.maids.join("・")}）`;
  } else {
    elSecond.style.display = "none";
  }
  elResult.style.display = "block";
  window.scrollTo({ top: elResult.offsetTop - 12, behavior: "smooth" });
}

function resetQuiz() {
  renderQuiz();
  elResult.style.display = "none";
}

document.getElementById("btnSubmit").addEventListener("click", showResult);
document.getElementById("btnReset").addEventListener("click", resetQuiz);
renderQuiz();
</script>
</body>
</html>
